WITH _ AS(SELECT date AS date1, date2, datediff(MONTH, date, date2) - iif(datepart(DAY, date2) < datepart(DAY, date) AND datepart(DAY, date) <= datepart(DAY, eomonth(date2)), 1, 0) AS months FROM battles CROSS apply (SELECT coalesce(min(date), getdate()) date2 FROM battles b WHERE b.date > battles.date) x) SELECT CASE WHEN months/12 > 0 THEN cast(months/12 AS varchar(4)) + CASE WHEN months - months/12 *12 > 0 THEN ' y., ' ELSE ' y.' END ELSE '' END + CASE WHEN months - months/12 *12 > 0 THEN cast(months - months/12 * 12 AS varchar(2)) + ' m.' ELSE '' END AS age, convert(varchar(10), date1, 127) AS date1, convert(varchar(10), date2, 127) AS date2 FROM _