WITH t AS(SELECT name, town_from, town_to FROM Passenger p LEFT JOIN pass_in_trip t ON t.id_psg=p.id_psg LEFT JOIN Trip r ON r.trip_no=t.trip_no WHERE town_from IS NOT NULL OR town_to IS NOT NULL), RES AS (SELECT name, c FROM (SELECT name, count(name) c FROM (SELECT DISTINCT name, town_from FROM (SELECT name, town_from FROM t UNION ALL SELECT name, town_to FROM t)_) x GROUP BY name) F WHERE c= (SELECT max(c) FROM (SELECT name, count(name) c FROM (SELECT DISTINCT name, town_from FROM (SELECT name, town_from FROM t UNION ALL SELECT name, town_to FROM t)_) x GROUP BY name) b)) SELECT name FROM RES