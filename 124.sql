WITH _ AS(SELECT ID_psg, ID_comp, max(count(*)) OVER (PARTITION BY ID_psg) AS mxctc, min(count(*)) OVER (PARTITION BY ID_psg) AS mnctc, count(*) OVER (PARTITION BY ID_psg) AS cc FROM Pass_in_trip JOIN Trip ON Trip. trip_no = Pass_in_trip. trip_no GROUP BY ID_psg, ID_comp) SELECT name FROM Passenger JOIN _ ON _. ID_psg = Passenger. ID_psg WHERE _.mxctc = _.mnctc AND _.cc >= 2 GROUP BY Passenger. ID_psg, name;