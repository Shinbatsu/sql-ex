WITH _ AS(SELECT COUNT(model) grp FROM product WHERE TYPE='printer'), _2 AS (SELECT xuy-(_.grp*((xuy-1)/_.grp)) num, model, TYPE, 2 pizda FROM (SELECT model, row_number() over( ORDER BY model) xuy, TYPE FROM product WHERE TYPE = 'pc')a, _ UNION ALL SELECT ROW_NUMBER() over( ORDER BY model), model, TYPE, 1 FROM product WHERE TYPE='printer') SELECT row_number() over( ORDER BY num, pizda, model), model, TYPE FROM _2 ORDER BY num, pizda, model