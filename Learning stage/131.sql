WITH _a AS(SELECT DISTINCT town_from town FROM Trip UNION SELECT town_to FROM Trip), _b AS (SELECT 'a' s UNION ALL SELECT 'e' UNION ALL SELECT 'i' UNION ALL SELECT 'o' UNION ALL SELECT 'u'), _c AS (SELECT town, DATALENGTH(_a.town) - DATALENGTH(replace(_a.town, s, '')) AS cs FROM _a, _b), _e AS (SELECT town, cs, count(*) over(PARTITION BY _c.town) cc, max(cs) over(PARTITION BY _c.town) mxc, min(cs) over(PARTITION BY _c.town) mnc FROM _c WHERE cs > 0) SELECT DISTINCT town FROM _e WHERE cc > 1 AND mxc = mnc;