WITH cta AS(SELECT POINT, date, sum(OUT) s FROM outcome WHERE POINT in (SELECT POINT FROM Outcome_o) GROUP BY POINT, date), ctb AS (SELECT POINT, date, sum(OUT) s FROM outcome_o WHERE POINT in (SELECT POINT FROM Outcome) GROUP BY POINT, date), ctc AS (SELECT coalesce(cta.point, ctb.point) AS POINT, coalesce(cta.date, ctb.date) AS date, coalesce(cta.s, 0) AS sa, coalesce(ctb.s, 0) AS sb FROM cta FULL JOIN ctb ON ctb.date = cta.date AND ctb.point = cta.point) SELECT ctc.point, ctc.date, CASE WHEN sa > sb THEN 'more than once a day' WHEN sa < sb THEN 'once a day' ELSE 'both' END lider FROM ctc ORDER BY ctc.point, ctc.date